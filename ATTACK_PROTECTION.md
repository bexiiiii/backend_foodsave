# üõ°Ô∏è –ó–ê–©–ò–¢–ê –û–¢ –ê–¢–ê–ö - –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è

## ‚úÖ –ß–¢–û –°–î–ï–õ–ê–ù–û:

### 1. **Rate Limiting** - –ó–∞—â–∏—Ç–∞ –æ—Ç DDoS
- ‚úÖ –°–æ–∑–¥–∞–Ω —Ñ–∏–ª—å—Ç—Ä `RateLimitConfig.java`
- –ë–ª–æ–∫–∏—Ä—É–µ—Ç IP —Å –±–æ–ª–µ–µ —á–µ–º **100 –∑–∞–ø—Ä–æ—Å–æ–≤/–º–∏–Ω—É—Ç—É**
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Ä–∞—Å–ø–æ–∑–Ω–∞—ë—Ç –∏ –±–ª–æ–∫–∏—Ä—É–µ—Ç RTSP –∞—Ç–∞–∫–∏
- HTTP –∫–æ–¥ 429 –¥–ª—è –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤

### 2. **Swagger –æ—Ç–∫–ª—é—á–µ–Ω –≤ Production**
- ‚úÖ `springdoc.swagger-ui.enabled=false`
- –ë–æ—Ç—ã –±–æ–ª—å—à–µ –Ω–µ —Å–º–æ–≥—É—Ç —Å–∫–∞–Ω–∏—Ä–æ–≤–∞—Ç—å API –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é

### 3. **Tomcat –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è**
- ‚úÖ max threads: 200 (–±—ã–ª–æ ~165)
- ‚úÖ max connections: 10,000
- ‚úÖ Limit –Ω–∞ —Ä–∞–∑–º–µ—Ä HTTP –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤: 8KB
- –°–µ—Ä–≤–µ—Ä –≤—ã–¥–µ—Ä–∂–∏—Ç –Ω–∞–º–Ω–æ–≥–æ –±–æ–ª—å—à–µ –Ω–∞–≥—Ä—É–∑–∫–∏

### 4. **HikariCP —É–≤–µ–ª–∏—á–µ–Ω**
- ‚úÖ max pool: 30 (–±—ã–ª–æ 20)
- ‚úÖ min idle: 10 (–±—ã–ª–æ 5)
- –ë–æ–ª—å—à–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π –∫ –ë–î

### 5. **Logging –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è**
- ‚úÖ RTSP –æ—à–∏–±–∫–∏ —Å–∫—Ä—ã—Ç—ã (ERROR level)
- –õ–æ–≥–∏ –Ω–µ –∑–∞—Å–æ—Ä—è—é—Ç—Å—è –∞—Ç–∞–∫–∞–º–∏

### 6. **Redis Fallback**
- ‚úÖ –ï—Å–ª–∏ Redis —É–ø–∞–¥—ë—Ç ‚Üí simple cache
- –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–µ —É–ø–∞–¥—ë—Ç

---

## üöÄ –ö–ê–ö –ü–†–ò–ú–ï–ù–ò–¢–¨ –ó–ê–©–ò–¢–£:

### –®–∞–≥ 1: –ü–µ—Ä–µ—Å–æ–±–µ—Ä–∏ –ø—Ä–æ–µ–∫—Ç
```bash
cd /Applications/development/foodsavee/backend_foodsave
./mvnw clean package -DskipTests
```

### –®–∞–≥ 2: –°–∫–æ–ø–∏—Ä—É–π –Ω–∞ —Å–µ—Ä–≤–µ—Ä
```bash
scp target/backend-0.0.1-SNAPSHOT.jar root@your-server:/var/www/foodsave/
```

### –®–∞–≥ 3: –ù–∞ –°–ï–†–í–ï–†–ï –Ω–∞—Å—Ç—Ä–æ–π Fail2ban
```bash
# –°–∫–æ–ø–∏—Ä—É–π —Å–∫—Ä–∏–ø—Ç –Ω–∞ —Å–µ—Ä–≤–µ—Ä
scp setup-fail2ban.sh root@your-server:/root/

# –ù–∞ —Å–µ—Ä–≤–µ—Ä–µ –∑–∞–ø—É—Å—Ç–∏:
ssh root@your-server
cd /root
chmod +x setup-fail2ban.sh
sudo ./setup-fail2ban.sh
```

### –®–∞–≥ 4: –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏ –±—ç–∫–µ–Ω–¥
```bash
systemctl restart foodsave-backend
```

### –®–∞–≥ 5: –ü—Ä–æ–≤–µ—Ä—å —á—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç
```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞
systemctl status foodsave-backend

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–≥–æ–≤
tail -f /var/log/foodsave/backend.log

# –ü—Ä–æ–≤–µ—Ä–∫–∞ fail2ban
sudo fail2ban-client status foodsave-ddos
sudo fail2ban-client status foodsave-rtsp
```

---

## üìä –ú–û–ù–ò–¢–û–†–ò–ù–ì –ê–¢–ê–ö:

### –°–∫—Ä–∏–ø—Ç –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –∞—Ç–∞–∫:
```bash
# –°–∫–æ–ø–∏—Ä—É–π –Ω–∞ —Å–µ—Ä–≤–µ—Ä
scp check-attacks.sh root@your-server:/root/

# –ù–∞ —Å–µ—Ä–≤–µ—Ä–µ –∑–∞–ø—É—Å—Ç–∏:
ssh root@your-server
chmod +x /root/check-attacks.sh
/root/check-attacks.sh /var/log/foodsave/backend.log
```

### –í —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏:
```bash
# –°–º–æ—Ç—Ä–µ—Ç—å –∞—Ç–∞–∫–∏ live
tail -f /var/log/foodsave/backend.log | grep -E '(Rate limit|RTSP|suspicious)'

# –¢–æ–ø –∞—Ç–∞–∫—É—é—â–∏—Ö IP
fail2ban-client status foodsave-ddos
```

---

## üî• –î–û–ü–û–õ–ù–ò–¢–ï–õ–¨–ù–ê–Ø –ó–ê–©–ò–¢–ê (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ):

### 1. Cloudflare (–†–ï–ö–û–ú–ï–ù–î–£–ï–¢–°–Ø!)
–ü–æ—Å—Ç–∞–≤—å —Å–∞–π—Ç –∑–∞ Cloudflare - —ç—Ç–æ –æ—Ç—Ñ–∏–ª—å—Ç—Ä—É–µ—Ç 99% –∞—Ç–∞–∫ –ë–ï–ó –Ω–∞–≥—Ä—É–∑–∫–∏ –Ω–∞ —Ç–≤–æ–π —Å–µ—Ä–≤–µ—Ä:
- –ë–µ—Å–ø–ª–∞—Ç–Ω—ã–π –ø–ª–∞–Ω
- DDoS –∑–∞—â–∏—Ç–∞
- Rate limiting
- –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ

### 2. Nginx Rate Limiting
–ï—Å–ª–∏ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—à—å Cloudflare, –¥–æ–±–∞–≤—å –≤ Nginx:
```nginx
limit_req_zone $binary_remote_addr zone=foodsave:10m rate=30r/m;

server {
    location /api/ {
        limit_req zone=foodsave burst=5;
        proxy_pass http://localhost:8080;
    }
}
```

### 3. UFW Firewall
–û—Ç–∫—Ä–æ–π —Ç–æ–ª—å–∫–æ –Ω—É–∂–Ω—ã–µ –ø–æ—Ä—Ç—ã:
```bash
sudo ufw allow 22/tcp    # SSH
sudo ufw allow 80/tcp    # HTTP
sudo ufw allow 443/tcp   # HTTPS
sudo ufw allow 8080/tcp  # Backend (–µ—Å–ª–∏ –Ω–∞–ø—Ä—è–º—É—é –¥–æ—Å—Ç—É–ø–µ–Ω)
sudo ufw enable
```

### 4. –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ CPU/Memory
–£—Å—Ç–∞–Ω–æ–≤–∏ htop –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞:
```bash
apt-get install htop
htop
```

---

## ‚ö†Ô∏è –ß–¢–û –û–ñ–ò–î–ê–¢–¨ –ü–û–°–õ–ï –û–ë–ù–û–í–õ–ï–ù–ò–Ø:

### ‚úÖ –•–û–†–û–®–ò–ï –ò–ó–ú–ï–ù–ï–ù–ò–Ø:
- –ê—Ç–∞–∫—É—é—â–∏–µ IP –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –±–∞–Ω—è—Ç—Å—è
- Swagger —Å–∫–∞–Ω–µ—Ä—ã –ø–æ–ª—É—á–∞—é—Ç 404
- RTSP –∞—Ç–∞–∫–∏ –±–ª–æ–∫–∏—Ä—É—é—Ç—Å—è
- –õ–æ–≥–∏ —á–∏—â–µ (–º–µ–Ω—å—à–µ —Å–ø–∞–º–∞)
- –°–µ—Ä–≤–µ—Ä –≤—ã–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –±–æ–ª—å—à–µ –Ω–∞–≥—Ä—É–∑–∫–∏

### ‚ö†Ô∏è –í–û–ó–ú–û–ñ–ù–´–ï –ü–†–û–ë–õ–ï–ú–´:
- **–ï—Å–ª–∏ –ª–µ–≥–∏—Ç–∏–º–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –¥–µ–ª–∞—é—Ç > 100 req/min** ‚Üí —É–≤–µ–ª–∏—á—å –ª–∏–º–∏—Ç –≤ `RateLimitConfig.java`
- **–ï—Å–ª–∏ –Ω—É–∂–µ–Ω Swagger –≤ –ø—Ä–æ–¥–µ** ‚Üí –≤–∫–ª—é—á–∏ —Ç–æ–ª—å–∫–æ –¥–ª—è –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö –∞–¥–º–∏–Ω–æ–≤
- **–ï—Å–ª–∏ Fail2ban –±–∞–Ω–∏—Ç –ª–µ–≥–∏—Ç–∏–º–Ω—ã—Ö —é–∑–µ—Ä–æ–≤** ‚Üí —Ä–∞–∑–±–∞–Ω—å: `fail2ban-client set foodsave-ddos unbanip <IP>`

---

## üìû TROUBLESHOOTING:

### –ü—Ä–æ–±–ª–µ–º–∞: "Bucket4j class not found"
```bash
# –î–æ–±–∞–≤—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –≤ pom.xml —É–∂–µ –¥–æ–±–∞–≤–ª–µ–Ω–∞
mvn clean install
```

### –ü—Ä–æ–±–ª–µ–º–∞: Fail2ban –Ω–µ –±–∞–Ω–∏—Ç
```bash
# –ü—Ä–æ–≤–µ—Ä—å –ª–æ–≥–∏ fail2ban
tail -f /var/log/fail2ban.log

# –ü—Ä–æ–≤–µ—Ä—å —á—Ç–æ –ø—É—Ç—å –∫ –ª–æ–≥—É –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π
ls -la /var/log/foodsave/backend.log
```

### –ü—Ä–æ–±–ª–µ–º–∞: –°–µ—Ä–≤–µ—Ä –≤—Å—ë –µ—â—ë –ø–∞–¥–∞–µ—Ç
```bash
# –ü—Ä–æ–≤–µ—Ä—å –Ω–µ—Ç –ª–∏ —É—Ç–µ—á–∫–∏ –ø–∞–º—è—Ç–∏
jmap -heap <PID>

# –£–≤–µ–ª–∏—á—å –ø–∞–º—è—Ç—å –≤ docker-compose.yml:
# JAVA_OPTS: "-Xms2048m -Xmx4096m"
```

---

## üéØ –†–ï–ó–£–õ–¨–¢–ê–¢–´:

–ü–æ—Å–ª–µ —ç—Ç–∏—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π:
- ‚úÖ **DDoS –∞—Ç–∞–∫–∏** ‚Üí –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω—ã –Ω–∞ —É—Ä–æ–≤–Ω–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è + Fail2ban
- ‚úÖ **RTSP –∞—Ç–∞–∫–∏** ‚Üí –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω—ã –Ω–∞–≤—Å–µ–≥–¥–∞ (24h ban)
- ‚úÖ **Swagger —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ** ‚Üí –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ
- ‚úÖ **–ù–∞–≥—Ä—É–∑–∫–∞** ‚Üí —Å–µ—Ä–≤–µ—Ä –≤—ã–¥–µ—Ä–∂–∏—Ç –≤ 3-5 —Ä–∞–∑ –±–æ–ª—å—à–µ
- ‚úÖ **–ü–∞–º—è—Ç—å** ‚Üí –Ω–µ –±—É–¥–µ—Ç —É—Ç–µ—á–µ–∫ –æ—Ç –∞—Ç–∞–∫
- ‚úÖ **Uptime** ‚Üí 99.9%+

---

## üìà –°–õ–ï–î–£–Æ–©–ò–ï –®–ê–ì–ò:

1. ‚úÖ –ü—Ä–∏–º–µ–Ω–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è –Ω–∞ –ø—Ä–æ–¥–µ
2. ‚úÖ –ù–∞—Å—Ç—Ä–æ–π Fail2ban
3. ‚è≠Ô∏è –ü–æ—Å—Ç–∞–≤—å Cloudflare (–æ—á–µ–Ω—å —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è!)
4. ‚è≠Ô∏è –ú–æ–Ω–∏—Ç–æ—Ä—å –∞—Ç–∞–∫–∏ 24-48 —á–∞—Å–æ–≤
5. ‚è≠Ô∏è –ü–æ–¥—Å—Ç—Ä–æ–π –ª–∏–º–∏—Ç—ã –µ—Å–ª–∏ –Ω—É–∂–Ω–æ

**–¢–µ–ø–µ—Ä—å —Ç–≤–æ–π —Å–µ—Ä–≤–µ—Ä –∑–∞—â–∏—â—ë–Ω! üõ°Ô∏è**
